<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>tropycal.recon.realtime &mdash; tropycal </title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sg_gallery-rendered-html.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="../../../_static/logo_32.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> tropycal
            <img src="../../../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/index.html">Example Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sample_usage.html">Example Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data.html">Data Sources</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">tropycal</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html">Module code</a> &raquo;</li>
      <li>tropycal.recon.realtime</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for tropycal.recon.realtime</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">urllib3</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span> <span class="k">as</span> <span class="n">dt</span><span class="p">,</span><span class="n">timedelta</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">.plot</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.tools</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">..utils</span> <span class="kn">import</span> <span class="o">*</span>

<div class="viewcode-block" id="RealtimeRecon"><a class="viewcode-back" href="../../../api/generated/tropycal.recon.RealtimeRecon.html#tropycal.recon.RealtimeRecon">[docs]</a><span class="k">class</span> <span class="nc">RealtimeRecon</span><span class="p">():</span>
    
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates an instance of a RealtimeRecon object.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    hours : int</span>
<span class="sd">        Number of hours to search back for recon missions. Default is 6 hours. Max allowed is 48 hours.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    RealtimeRecon</span>
<span class="sd">        Instance of a RealtimeRecon object.</span>
<span class="sd">    </span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    .. warning::</span>

<span class="sd">        RealtimeRecon data is retrieved directly through NHC&#39;s archive, though this source can lag by up to 40 minutes compared to the very latest recon data available directly on their website.</span>
<span class="sd">    </span>
<span class="sd">    The ``RealtimeRecon`` Class and accompanying ``Mission`` class make up the realtime part of the recon module. Unlike the ``ReconDataset`` Class and its accompanying ``hdobs``, ``dropsondes`` and ``vdms`` classes which are **storm-centric**, the realtime recon functionality is **mission-centric**.</span>
<span class="sd">    </span>
<span class="sd">    This mission-centric functionality means realtime recon missions lack the storm-centering functionality that the more comprehensive full recon functionality has, but is also much faster at reading recon data for realtime purposes and includes non-tropical cyclone recon missions.</span>
<span class="sd">    </span>
<span class="sd">    The following example shows how to use realtime recon functionality. First, create an instance of ``RealtimeRecon``, which retrieves all active missions within the specified hour window (default is the most recent 6 hours):</span>
<span class="sd">    </span>
<span class="sd">    .. code-block:: python</span>
<span class="sd">    </span>
<span class="sd">        from tropycal import recon</span>
<span class="sd">        realtime_obj = recon.RealtimeRecon()</span>
<span class="sd">        </span>
<span class="sd">    We can now quickly retrieve a list of all active mission IDs:</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; realtime_obj.get_mission_ids()</span>
<span class="sd">    [&#39;AF306-0801A-ALEX&#39;, &#39;AF303-0901A-ALEX&#39;]</span>
<span class="sd">    </span>
<span class="sd">    Now use the ``get_mission()`` method to retrieve a Mission object containing all available data (HDOBs, VDMs &amp; dropsondes) for this mission. The resulting object can access all of the methods and attributes of the ``Mission`` class.</span>
<span class="sd">    </span>
<span class="sd">    .. code-block:: python</span>
<span class="sd">        </span>
<span class="sd">        mission = realtime_obj.get_mission(&#39;AF303-0901A-ALEX&#39;)</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&lt;tropycal.recon.RealtimeRecon&gt;&quot;</span><span class="p">]</span>

        <span class="c1">#Add dataset summary</span>
        <span class="n">summary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Dataset Summary:&quot;</span><span class="p">)</span>
        <span class="n">summary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="mi">4</span><span class="si">}</span><span class="s1">Numbers of active missions: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">summary</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">hours</span><span class="o">=</span><span class="mi">6</span><span class="p">):</span>

        <span class="c1">#Error check</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hours</span> <span class="o">=</span> <span class="n">hours</span>
        <span class="k">if</span> <span class="n">hours</span> <span class="o">&gt;</span> <span class="mi">48</span> <span class="ow">or</span> <span class="n">hours</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Maximum allowed search is 48 hours back.&quot;</span><span class="p">)</span>
        
        <span class="c1">#Start timing</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--&gt; Searching for active missions&quot;</span><span class="p">)</span>
        <span class="n">timer_start</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>

        <span class="c1">#Set URLs for reading data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">urls</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;hdobs&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;https://www.nhc.noaa.gov/archive/recon/</span><span class="si">{</span><span class="n">dt</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">year</span><span class="si">}</span><span class="s1">/AHONT1/&#39;</span><span class="p">,</span>
            <span class="s1">&#39;dropsondes&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;https://www.nhc.noaa.gov/archive/recon/</span><span class="si">{</span><span class="n">dt</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">year</span><span class="si">}</span><span class="s1">/REPNT3/&#39;</span><span class="p">,</span>
            <span class="s1">&#39;vdms&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;https://www.nhc.noaa.gov/archive/recon/</span><span class="si">{</span><span class="n">dt</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">year</span><span class="si">}</span><span class="s1">/REPNT2/&#39;</span>
        <span class="p">}</span>

        <span class="c1">#Start time set by hour window</span>
        <span class="n">start_time_request</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="n">hours</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="n">hours</span><span class="o">+</span><span class="mi">12</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_time_request</span> <span class="o">=</span> <span class="n">start_time_request</span>

        <span class="c1">#Retrieve list of files in URL and filter by storm dates</span>
        <span class="n">files</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;hdobs&#39;</span><span class="p">:[],</span><span class="s1">&#39;dropsondes&#39;</span><span class="p">:[],</span><span class="s1">&#39;vdms&#39;</span><span class="p">:[]}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">files</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">page</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">urls</span><span class="p">[</span><span class="n">key</span><span class="p">])</span><span class="o">.</span><span class="n">text</span>
            <span class="n">content</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">file_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">content</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;.txt&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span> <span class="n">file_list</span><span class="o">.</span><span class="n">append</span><span class="p">(((</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;txt&quot;&gt;&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&lt;/a&gt;&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">))</span>
            <span class="k">del</span> <span class="n">content</span>
            <span class="n">file_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">file_list</span> <span class="k">if</span> <span class="n">dt</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="mi">10</span><span class="p">],</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">%H&#39;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">start_time</span><span class="p">],</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">files</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">urls</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">file_list</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">files</span> <span class="o">=</span> <span class="n">files</span>

        <span class="c1">#Retrieve all active missions &amp; read HDOBs</span>
        <span class="n">urllib3</span><span class="o">.</span><span class="n">disable_warnings</span><span class="p">()</span>
        <span class="n">http</span> <span class="o">=</span> <span class="n">urllib3</span><span class="o">.</span><span class="n">PoolManager</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">missions</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">[</span><span class="s1">&#39;hdobs&#39;</span><span class="p">]:</span>

            <span class="c1">#Retrieve content</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span><span class="n">file</span><span class="p">)</span>
            <span class="n">content</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
            <span class="n">content_split</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1">#Construct mission ID</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">mission_id</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">content_split</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">))</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[:</span><span class="mi">3</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">mission_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="p">[</span><span class="n">mission_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;hdobs&#39;</span><span class="p">:</span><span class="n">decode_hdob</span><span class="p">(</span><span class="n">content</span><span class="p">),</span>
                                            <span class="s1">&#39;vdms&#39;</span><span class="p">:[],</span>
                                            <span class="s1">&#39;dropsondes&#39;</span><span class="p">:[],</span>
                                            <span class="s1">&#39;aircraft&#39;</span><span class="p">:</span><span class="n">mission_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
                                            <span class="s1">&#39;storm_name&#39;</span><span class="p">:</span><span class="n">mission_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
                                           <span class="p">}</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="p">[</span><span class="n">mission_id</span><span class="p">][</span><span class="s1">&#39;hdobs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="p">[</span><span class="n">mission_id</span><span class="p">][</span><span class="s1">&#39;hdobs&#39;</span><span class="p">],</span><span class="n">decode_hdob</span><span class="p">(</span><span class="n">content</span><span class="p">)])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="c1">#Retrieve VDMs</span>
        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">[</span><span class="s1">&#39;vdms&#39;</span><span class="p">]:</span>

            <span class="c1">#Retrieve content</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span><span class="n">file</span><span class="p">)</span>
            <span class="n">content</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
            <span class="n">content_split</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1">#Construct mission ID</span>
            <span class="n">mission_id</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;U. &quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[:</span><span class="mi">3</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">content_split</span> <span class="k">if</span> <span class="n">i</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;U.&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">date</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">strptime</span><span class="p">((</span><span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">])[:</span><span class="mi">8</span><span class="p">],</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">blank</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">decode_vdm</span><span class="p">(</span><span class="n">content</span><span class="p">,</span><span class="n">date</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">mission_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="p">[</span><span class="n">mission_id</span><span class="p">][</span><span class="s1">&#39;vdms&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1">#Retrieve dropsondes</span>
        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">[</span><span class="s1">&#39;dropsondes&#39;</span><span class="p">]:</span>

            <span class="c1">#Retrieve content</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span><span class="n">file</span><span class="p">)</span>
            <span class="n">content</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
            <span class="n">content_split</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1">#Construct mission ID</span>
            <span class="n">mission_id</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;61616 &quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[:</span><span class="mi">3</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">content_split</span> <span class="k">if</span> <span class="n">i</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;61616&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">date</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">strptime</span><span class="p">((</span><span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">])[:</span><span class="mi">8</span><span class="p">],</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">blank</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">decode_dropsonde</span><span class="p">(</span><span class="n">content</span><span class="p">,</span><span class="n">date</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">mission_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="p">[</span><span class="n">mission_id</span><span class="p">][</span><span class="s1">&#39;dropsondes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1">#Temporally filter missions</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="n">end_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;hdobs&#39;</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">end_date</span> <span class="o">&lt;</span> <span class="n">start_time_request</span><span class="p">:</span> <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        
        <span class="c1">#Sort each mission by date</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;hdobs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;time&#39;</span><span class="p">],</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="c1">#Save current time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        
        <span class="c1">#Add attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;hours&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">hours</span><span class="p">,</span>
            <span class="s1">&#39;time&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
        <span class="p">}</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--&gt; Completed retrieving active missions (</span><span class="si">{</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">-</span><span class="n">timer_start</span><span class="p">)</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> seconds)&quot;</span><span class="p">)</span>
        
<div class="viewcode-block" id="RealtimeRecon.update"><a class="viewcode-back" href="../../../api/generated/tropycal.recon.RealtimeRecon.update.html#tropycal.recon.RealtimeRecon.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates RealtimeRecon with the latest available data.</span>
<span class="sd">        </span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This function has no return value, but simply updates RealtimeRecon with the latest available recon data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1">#Start timing</span>
        <span class="n">timer_start</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        
        <span class="c1">#Start time set by hour window</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">start_time</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_time_request</span><span class="p">:</span> <span class="n">start_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_time_request</span>

        <span class="c1">#Retrieve list of files in URL and filter by storm dates</span>
        <span class="n">files</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;hdobs&#39;</span><span class="p">:[],</span><span class="s1">&#39;dropsondes&#39;</span><span class="p">:[],</span><span class="s1">&#39;vdms&#39;</span><span class="p">:[]}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">files</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">page</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">urls</span><span class="p">[</span><span class="n">key</span><span class="p">])</span><span class="o">.</span><span class="n">text</span>
            <span class="n">content</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">file_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">content</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;.txt&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span> <span class="n">file_list</span><span class="o">.</span><span class="n">append</span><span class="p">(((</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;txt&quot;&gt;&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&lt;/a&gt;&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">))</span>
            <span class="k">del</span> <span class="n">content</span>
            <span class="n">file_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">file_list</span> <span class="k">if</span> <span class="n">dt</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="mi">10</span><span class="p">],</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">%H&#39;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">start_time</span><span class="p">],</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">files</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">urls</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">file_list</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">urls</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="n">key</span><span class="p">]]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">+=</span> <span class="n">files</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        
        <span class="c1">#Retrieve all active missions &amp; read HDOBs</span>
        <span class="n">urllib3</span><span class="o">.</span><span class="n">disable_warnings</span><span class="p">()</span>
        <span class="n">http</span> <span class="o">=</span> <span class="n">urllib3</span><span class="o">.</span><span class="n">PoolManager</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">[</span><span class="s1">&#39;hdobs&#39;</span><span class="p">]:</span>

            <span class="c1">#Retrieve content</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span><span class="n">file</span><span class="p">)</span>
            <span class="n">content</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
            <span class="n">content_split</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1">#Construct mission ID</span>
            <span class="n">mission_id</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">content_split</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">))</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[:</span><span class="mi">3</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">mission_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="p">[</span><span class="n">mission_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;hdobs&#39;</span><span class="p">:</span><span class="n">decode_hdob</span><span class="p">(</span><span class="n">content</span><span class="p">),</span>
                                        <span class="s1">&#39;vdms&#39;</span><span class="p">:[],</span>
                                        <span class="s1">&#39;dropsondes&#39;</span><span class="p">:[],</span>
                                        <span class="s1">&#39;aircraft&#39;</span><span class="p">:</span><span class="n">mission_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
                                        <span class="s1">&#39;storm_name&#39;</span><span class="p">:</span><span class="n">mission_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
                                       <span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="p">[</span><span class="n">mission_id</span><span class="p">][</span><span class="s1">&#39;hdobs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="p">[</span><span class="n">mission_id</span><span class="p">][</span><span class="s1">&#39;hdobs&#39;</span><span class="p">],</span><span class="n">decode_hdob</span><span class="p">(</span><span class="n">content</span><span class="p">)])</span>

        <span class="c1">#Retrieve VDMs</span>
        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">[</span><span class="s1">&#39;vdms&#39;</span><span class="p">]:</span>

            <span class="c1">#Retrieve content</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span><span class="n">file</span><span class="p">)</span>
            <span class="n">content</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
            <span class="n">content_split</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1">#Construct mission ID</span>
            <span class="n">mission_id</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;U. &quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[:</span><span class="mi">3</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">content_split</span> <span class="k">if</span> <span class="n">i</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;U.&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">date</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">strptime</span><span class="p">((</span><span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">])[:</span><span class="mi">8</span><span class="p">],</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">blank</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">decode_vdm</span><span class="p">(</span><span class="n">content</span><span class="p">,</span><span class="n">date</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">mission_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="p">[</span><span class="n">mission_id</span><span class="p">][</span><span class="s1">&#39;vdms&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1">#Retrieve dropsondes</span>
        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">[</span><span class="s1">&#39;dropsondes&#39;</span><span class="p">]:</span>

            <span class="c1">#Retrieve content</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span><span class="n">file</span><span class="p">)</span>
            <span class="n">content</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
            <span class="n">content_split</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1">#Construct mission ID</span>
            <span class="n">mission_id</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;61616 &quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[:</span><span class="mi">3</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">content_split</span> <span class="k">if</span> <span class="n">i</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;61616&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">date</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">strptime</span><span class="p">((</span><span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">])[:</span><span class="mi">8</span><span class="p">],</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">blank</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">decode_dropsonde</span><span class="p">(</span><span class="n">content</span><span class="p">,</span><span class="n">date</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">mission_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="p">[</span><span class="n">mission_id</span><span class="p">][</span><span class="s1">&#39;dropsondes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        
        <span class="c1">#Temporally filter missions</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="n">end_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;hdobs&#39;</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">start_time_request</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hours</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">end_date</span> <span class="o">&lt;</span> <span class="n">start_time_request</span><span class="p">:</span> <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        
        <span class="c1">#Sort each mission by date</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;hdobs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;time&#39;</span><span class="p">],</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--&gt; Completed updating mission data (</span><span class="si">{</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">-</span><span class="n">timer_start</span><span class="p">)</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> seconds)&quot;</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="RealtimeRecon.get_mission"><a class="viewcode-back" href="../../../api/generated/tropycal.recon.RealtimeRecon.get_mission.html#tropycal.recon.RealtimeRecon.get_mission">[docs]</a>    <span class="k">def</span> <span class="nf">get_mission</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mission_id</span><span class="p">):</span>
        
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve a Mission object given the mission ID.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mission_id : str</span>
<span class="sd">            String denoting requested mission ID. All active mission IDs can be retrieved using ``get_mission_ids()``.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tropycal.recon.Mission</span>
<span class="sd">            An instance of a Mission object for this mission.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">return</span> <span class="n">Mission</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="p">[</span><span class="n">mission_id</span><span class="p">],</span><span class="n">mission_id</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="RealtimeRecon.get_mission_ids"><a class="viewcode-back" href="../../../api/generated/tropycal.recon.RealtimeRecon.get_mission_ids.html#tropycal.recon.RealtimeRecon.get_mission_ids">[docs]</a>    <span class="k">def</span> <span class="nf">get_mission_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">storm_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve a list of all active mission IDs.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        storm_name : str, optional</span>
<span class="sd">            Storm name (case-insensitive) to filter the search by. If None, all active missions are searched.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            List containing all active mission IDs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">mission_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
        <span class="k">if</span> <span class="n">storm_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">mission_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">mission_ids</span> <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">storm_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span>
        
        <span class="k">return</span> <span class="n">mission_ids</span></div>
    
<div class="viewcode-block" id="RealtimeRecon.get_hdobs_summary"><a class="viewcode-back" href="../../../api/generated/tropycal.recon.RealtimeRecon.get_hdobs_summary.html#tropycal.recon.RealtimeRecon.get_hdobs_summary">[docs]</a>    <span class="k">def</span> <span class="nf">get_hdobs_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve the latest 10-minute HDOBs for all missions. Only valid for missions that were active within the last hour.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            Dictionary with the parsed HDOB data highlights.</span>
<span class="sd">        </span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        .. note::</span>
<span class="sd">            </span>
<span class="sd">            The decoded HDOBs summary automatically filters out all flagged observations for each variable. If all observations are flagged or missing for a variable, a value of NaN is returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">mission_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">sub_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">missions</span><span class="p">[</span><span class="n">mission_id</span><span class="p">][</span><span class="s1">&#39;hdobs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">sub_df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">dt</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">-</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span> <span class="k">continue</span>
            
            <span class="c1">#Parse data</span>
            <span class="n">array</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sub_df</span><span class="p">[</span><span class="s1">&#39;sfmr&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="s1">&#39;sfmr&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sub_df</span><span class="p">[</span><span class="s1">&#39;flag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
            <span class="n">max_sfmr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="k">if</span> <span class="n">all_nan</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

            <span class="n">array</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sub_df</span><span class="p">[</span><span class="s1">&#39;p_sfc&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="s1">&#39;p_sfc&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sub_df</span><span class="p">[</span><span class="s1">&#39;flag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
            <span class="n">min_p_sfc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="k">if</span> <span class="n">all_nan</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

            <span class="n">array</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sub_df</span><span class="p">[</span><span class="s1">&#39;wspd&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="s1">&#39;wspd&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sub_df</span><span class="p">[</span><span class="s1">&#39;flag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
            <span class="n">max_wspd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="k">if</span> <span class="n">all_nan</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

            <span class="n">array</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sub_df</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="s1">&#39;temp&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sub_df</span><span class="p">[</span><span class="s1">&#39;flag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
            <span class="n">max_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="k">if</span> <span class="n">all_nan</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

            <span class="n">array</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sub_df</span><span class="p">[</span><span class="s1">&#39;dwpt&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="s1">&#39;dwpt&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sub_df</span><span class="p">[</span><span class="s1">&#39;flag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
            <span class="n">max_dwpt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="k">if</span> <span class="n">all_nan</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            
            <span class="n">data</span><span class="p">[</span><span class="n">mission_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;min_mslp&#39;</span><span class="p">:</span> <span class="n">min_p_sfc</span><span class="p">,</span>
                <span class="s1">&#39;max_sfmr&#39;</span><span class="p">:</span> <span class="n">max_sfmr</span><span class="p">,</span>
                <span class="s1">&#39;max_wspd&#39;</span><span class="p">:</span> <span class="n">max_wspd</span><span class="p">,</span>
                <span class="s1">&#39;max_temp&#39;</span><span class="p">:</span> <span class="n">max_temp</span><span class="p">,</span>
                <span class="s1">&#39;max_dwpt&#39;</span><span class="p">:</span> <span class="n">max_dwpt</span><span class="p">,</span>
                <span class="s1">&#39;start_time&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">sub_df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                <span class="s1">&#39;end_time&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">sub_df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
            <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">data</span></div>
    
<div class="viewcode-block" id="RealtimeRecon.get_hdobs_realtime"><a class="viewcode-back" href="../../../api/generated/tropycal.recon.RealtimeRecon.get_hdobs_realtime.html#tropycal.recon.RealtimeRecon.get_hdobs_realtime">[docs]</a>    <span class="k">def</span> <span class="nf">get_hdobs_realtime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">basin</span><span class="p">,</span><span class="n">aircraft</span><span class="p">,</span><span class="n">decoded</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve the latest 10-minute HDOBs directly from NHC.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        basin : str</span>
<span class="sd">            Basin for which to retrieve the latest HDOBs for. Available options are ``&quot;north_atlantic&quot;`` or ``&quot;east_pacific&quot;``.</span>
<span class="sd">        aircraft : str</span>
<span class="sd">            Type of aircraft for recon mission. Available options are ``&quot;noaa&quot;`` or ``&quot;usaf&quot;`` (US Air Force).</span>
<span class="sd">        decoded : bool, optional</span>
<span class="sd">            If False, returns a Pandas DataFrame of all HDOBs. If True (default), returns a dictionary with decoded HDOBs highlights.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.DataFrame or dict</span>
<span class="sd">            Depending on the value of ``decoded``, returns either a Pandas DataFrame or a dictionary with the parsed HDOB data highlights.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        .. note::</span>
<span class="sd">            </span>
<span class="sd">            If using ``decoded=True``, the decoded HDOBs summary automatically filters out all flagged observations for each variable. If all observations are flagged or missing for a variable, a value of NaN is returned.</span>
<span class="sd">        </span>
<span class="sd">        The National Hurricane Center (NHC) website has 4 links for the latest HDOBs available:</span>

<span class="sd">        1. NOAA aircraft in the North Atlantic basin</span>
<span class="sd">        2. US Air Force (USAF) aircraft in the North Atlantic basin</span>
<span class="sd">        3. NOAA aircraft in the East Pacific basin</span>
<span class="sd">        4. US Air Force (USAF) aircraft in the East Pacific basin</span>

<span class="sd">        Each of these links store the most recent 10-minute HDOB observations from the most recent mission for each aircraft type and basin, regardless of how long ago that mission was.</span>
<span class="sd">        </span>
<span class="sd">        Note that this function is different from ``get_hdobs_summary()``, as the archived NHC recon observations can lag by 10 to as much as 40 minutes. This function fetches the recon observations directly from NHC&#39;s realtime recon webpage with the very latest data as soon as it comes in.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1">#Determine URL</span>
        <span class="k">if</span> <span class="n">basin</span> <span class="o">==</span> <span class="s1">&#39;north_atlantic&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">aircraft</span> <span class="o">==</span> <span class="s1">&#39;noaa&#39;</span><span class="p">:</span>
                <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://www.nhc.noaa.gov/text/URNT15-NOAA.shtml&#39;</span>
            <span class="k">elif</span> <span class="n">aircraft</span> <span class="o">==</span> <span class="s1">&#39;usaf&#39;</span><span class="p">:</span>
                <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://www.nhc.noaa.gov/text/URNT15-USAF.shtml&#39;</span>
        <span class="k">elif</span> <span class="n">basin</span> <span class="o">==</span> <span class="s1">&#39;east_pacific&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">aircraft</span> <span class="o">==</span> <span class="s1">&#39;noaa&#39;</span><span class="p">:</span>
                <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://www.nhc.noaa.gov/text/URPN15-NOAA.shtml&#39;</span>
            <span class="k">elif</span> <span class="n">aircraft</span> <span class="o">==</span> <span class="s1">&#39;usaf&#39;</span><span class="p">:</span>
                <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://www.nhc.noaa.gov/text/URPN15-USAF.shtml&#39;</span>

        <span class="c1">#Read URL content and get DataFrame</span>
        <span class="n">content</span> <span class="o">=</span> <span class="n">read_url</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">subsplit</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">hdob_content</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">content</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="s1">&#39;&lt;pre&gt;&#39;</span><span class="p">:</span>
                <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="k">continue</span>
                <span class="n">hdob_content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="s1">&#39;&lt;/pre&gt;&#39;</span><span class="p">:</span> <span class="k">break</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">decode_hdob</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">hdob_content</span><span class="p">),</span><span class="n">mission_row</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">decoded</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span> <span class="k">return</span> <span class="n">df</span>
        
        <span class="c1">#Parse data</span>
        <span class="n">array</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;sfmr&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="s1">&#39;sfmr&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;flag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">max_sfmr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="k">if</span> <span class="n">all_nan</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="n">array</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_sfc&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="s1">&#39;p_sfc&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;flag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">min_p_sfc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="k">if</span> <span class="n">all_nan</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="n">array</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;wspd&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="s1">&#39;wspd&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;flag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">max_wspd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="k">if</span> <span class="n">all_nan</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="n">array</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="s1">&#39;temp&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;flag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">max_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="k">if</span> <span class="n">all_nan</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="n">array</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;dwpt&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="s1">&#39;dwpt&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;flag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">max_dwpt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="k">if</span> <span class="n">all_nan</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;mission_id&#39;</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;mission_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;min_mslp&#39;</span><span class="p">:</span> <span class="n">min_p_sfc</span><span class="p">,</span>
            <span class="s1">&#39;max_sfmr&#39;</span><span class="p">:</span> <span class="n">max_sfmr</span><span class="p">,</span>
            <span class="s1">&#39;max_wspd&#39;</span><span class="p">:</span> <span class="n">max_wspd</span><span class="p">,</span>
            <span class="s1">&#39;max_temp&#39;</span><span class="p">:</span> <span class="n">max_temp</span><span class="p">,</span>
            <span class="s1">&#39;max_dwpt&#39;</span><span class="p">:</span> <span class="n">max_dwpt</span><span class="p">,</span>
            <span class="s1">&#39;start_time&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
            <span class="s1">&#39;end_time&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">data</span></div></div>
    
<span class="k">class</span> <span class="nc">PseudoStorm</span><span class="p">():</span>
    
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a dummy Storm object for functions that require a Storm object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:[</span><span class="s1">&#39;TS&#39;</span><span class="p">],</span><span class="s1">&#39;vmax&#39;</span><span class="p">:[</span><span class="mi">50</span><span class="p">],</span><span class="s1">&#39;wmo_basin&#39;</span><span class="p">:</span><span class="s1">&#39;north_atlantic&#39;</span><span class="p">,</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;Test&#39;</span><span class="p">}</span>

<div class="viewcode-block" id="Mission"><a class="viewcode-back" href="../../../api/generated/tropycal.recon.Mission.html#tropycal.recon.Mission">[docs]</a><span class="k">class</span> <span class="nc">Mission</span><span class="p">():</span>
    
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates an instance of a Mission object.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : dict</span>
<span class="sd">        Dictionary containing mission data. This is passed automatically from ``RealtimeRecon.get_mission()`` or ``ReconDataset.get_mission()``.</span>
<span class="sd">    mission_id : str</span>
<span class="sd">        String representing the full Mission ID. This is passed automatically from ``RealtimeRecon.get_mission()`` or ``ReconDataset.get_mission()``.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tropycal.recon.Mission</span>
<span class="sd">        An instance of a Mission object.</span>
<span class="sd">    </span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Mission objects can be retrieved via two methods. The first method is for realtime Recon missions, retrieved directly from ``RealtimeRecon`` objects provided a mission ID string. For this example below, we&#39;ll retrieve the latest mission available:</span>
<span class="sd">    </span>
<span class="sd">    .. code-block:: python</span>
<span class="sd">    </span>
<span class="sd">        #Read in all recent mission data</span>
<span class="sd">        from tropycal import recon</span>
<span class="sd">        realtime_obj = recon.RealtimeRecon()</span>
<span class="sd">        </span>
<span class="sd">        #Get latest mission ID string (or set this to any of the available mission IDs)</span>
<span class="sd">        latest_mission_id = realtime_obj.get_mission_ids()[-1]</span>
<span class="sd">        </span>
<span class="sd">        #Retrieve an instance of Mission</span>
<span class="sd">        mission = realtime_obj.get_mission(latest_mission_id)</span>
<span class="sd">    </span>
<span class="sd">    The second method to retrieve a Mission object is for archived recon missions, via ReconDataset:</span>
<span class="sd">    </span>
<span class="sd">    .. code-block:: python</span>
<span class="sd">    </span>
<span class="sd">        #Read in HURDATv2 dataset</span>
<span class="sd">        from tropycal import tracks</span>
<span class="sd">        basin = tracks.TrackDataset()</span>
<span class="sd">        storm = basin.get_storm((&#39;michael&#39;,2018))</span>
<span class="sd">        </span>
<span class="sd">        #Get mission #11</span>
<span class="sd">        mission = storm.recon.get_mission(11)</span>
<span class="sd">        </span>
<span class="sd">    This instance of Mission can now access all of the attributes and methods of the Mission class.</span>
<span class="sd">    </span>
<span class="sd">    Note that since the Mission object is mission-centric, not storm-centric, much of the functionality available in the storm-centric recon classes is not available here, though some of the plotting functionality (plotting HDOB points, time series, or dropsonde Skew-T) is available.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&lt;tropycal.recon.Mission&gt;&quot;</span><span class="p">]</span>
        
        <span class="c1">#Find maximum wind and minimum pressure</span>
        <span class="n">array</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hdobs</span><span class="p">[</span><span class="s1">&#39;sfmr&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="s1">&#39;sfmr&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdobs</span><span class="p">[</span><span class="s1">&#39;flag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">max_sfmr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="k">if</span> <span class="n">all_nan</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">array</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hdobs</span><span class="p">[</span><span class="s1">&#39;p_sfc&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="s1">&#39;p_sfc&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdobs</span><span class="p">[</span><span class="s1">&#39;flag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">min_psfc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="k">if</span> <span class="n">all_nan</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">array</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hdobs</span><span class="p">[</span><span class="s1">&#39;wspd&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="s1">&#39;wspd&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdobs</span><span class="p">[</span><span class="s1">&#39;flag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">max_wspd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="k">if</span> <span class="n">all_nan</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">array</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hdobs</span><span class="p">[</span><span class="s1">&#39;pkwnd&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="s1">&#39;pkwnd&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdobs</span><span class="p">[</span><span class="s1">&#39;flag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">max_pkwnd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="k">if</span> <span class="n">all_nan</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">time_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hdobs</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hdobs</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]))]</span>

        <span class="c1">#Add summary text</span>
        <span class="n">emdash</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\u2014</span><span class="s1">&#39;</span>
        <span class="n">summary_keys</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Dropsondes&#39;</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dropsondes</span><span class="p">),</span>
                        <span class="s1">&#39;VDMs&#39;</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vdms</span><span class="p">),</span>
                        <span class="s1">&#39;Max 30sec flight level wind&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">max_wspd</span><span class="si">}</span><span class="s2"> knots&quot;</span><span class="p">,</span>
                        <span class="s1">&#39;Max 10sec flight level wind&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">max_pkwnd</span><span class="si">}</span><span class="s2"> knots&quot;</span><span class="p">,</span>
                        <span class="s1">&#39;Max SFMR wind&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">max_sfmr</span><span class="si">}</span><span class="s2"> knots&quot;</span><span class="p">,</span>
                        <span class="s1">&#39;Min surface pressure&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">min_psfc</span><span class="si">}</span><span class="s2"> hPa&quot;</span><span class="p">}</span>
        
        <span class="c1">#Add text to output</span>
        <span class="n">summary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Mission Summary:&quot;</span><span class="p">)</span>
        <span class="n">add_space</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">summary_keys</span><span class="o">.</span><span class="n">keys</span><span class="p">()])</span><span class="o">+</span><span class="mi">3</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">summary_keys</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">key_name</span> <span class="o">=</span> <span class="n">key</span><span class="o">+</span><span class="s2">&quot;:&quot;</span>
            <span class="n">summary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="mi">4</span><span class="si">}{</span><span class="n">key_name</span><span class="si">:</span><span class="s1">&lt;</span><span class="si">{</span><span class="n">add_space</span><span class="si">}}{</span><span class="n">summary_keys</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        
        <span class="c1">#Add attributes</span>
        <span class="n">summary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Attributes:&quot;</span><span class="p">)</span>
        <span class="n">add_space</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">()])</span><span class="o">+</span><span class="mi">3</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">key_name</span> <span class="o">=</span> <span class="n">key</span><span class="o">+</span><span class="s2">&quot;:&quot;</span>
            <span class="n">summary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="mi">4</span><span class="si">}{</span><span class="n">key_name</span><span class="si">:</span><span class="s1">&lt;</span><span class="si">{</span><span class="n">add_space</span><span class="si">}}{</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">summary</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">mission_id</span><span class="p">):</span>
        
        <span class="c1">#Retrieve variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vdms</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;vdms&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hdobs</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;hdobs&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dropsondes</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;dropsondes&#39;</span><span class="p">]</span>
        
        <span class="c1">#Retrieve attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mission_id</span> <span class="o">=</span> <span class="n">mission_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aircraft</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;aircraft&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">storm_name</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;storm_name&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mission_id</span> <span class="o">=</span> <span class="n">mission_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hdobs</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hdobs</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]))</span>
        
        <span class="c1">#Get sources</span>
        <span class="k">if</span> <span class="s1">&#39;source&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span><span class="o">.</span><span class="n">year</span> <span class="o">&lt;=</span> <span class="mi">2005</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span><span class="o">.</span><span class="n">year</span> <span class="o">&gt;=</span> <span class="mi">1989</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;National Hurricane Center (NHC)&#39;</span><span class="p">,</span><span class="s2">&quot;UCAR&#39;s Tropical Cyclone Guidance Project (TCGP)&quot;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="s1">&#39;National Hurricane Center (NHC)&#39;</span>
        
        <span class="c1">#Retrieve attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;aircraft&#39;</span><span class="p">:</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;aircraft&#39;</span><span class="p">],</span>
            <span class="s1">&#39;storm_name&#39;</span><span class="p">:</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;storm_name&#39;</span><span class="p">],</span>
            <span class="s1">&#39;mission_id&#39;</span><span class="p">:</span><span class="n">mission_id</span><span class="p">,</span>
            <span class="s1">&#39;start_time&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hdobs</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">])),</span>
            <span class="s1">&#39;end_time&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hdobs</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">])),</span>
            <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">,</span>
        <span class="p">}</span>
        
        <span class="c1">#Add status for mission</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">aircraft</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;NOAA9&#39;</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Upper Air&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdobs</span><span class="p">[</span><span class="s1">&#39;plane_p&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;start_time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">year</span> <span class="o">&gt;=</span> <span class="mi">2007</span><span class="p">:</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">get_status</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hdobs</span><span class="p">[</span><span class="s1">&#39;plane_p&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">get_status</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hdobs</span><span class="p">[</span><span class="s1">&#39;plane_z&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">use_z</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdobs</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hdobs</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hdobs</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;status&#39;</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="n">values</span><span class="p">)</span>
    
<div class="viewcode-block" id="Mission.get_hdobs"><a class="viewcode-back" href="../../../api/generated/tropycal.recon.Mission.get_hdobs.html#tropycal.recon.Mission.get_hdobs">[docs]</a>    <span class="k">def</span> <span class="nf">get_hdobs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns High Density Observations (HDOBs) for this mission.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Pandas.DataFrame</span>
<span class="sd">            DataFrame containing HDOBs entries for this mission.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdobs</span></div>
        
<div class="viewcode-block" id="Mission.get_dropsondes"><a class="viewcode-back" href="../../../api/generated/tropycal.recon.Mission.get_dropsondes.html#tropycal.recon.Mission.get_dropsondes">[docs]</a>    <span class="k">def</span> <span class="nf">get_dropsondes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns dropsondes for this mission.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            Dictionary containing dropsonde data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropsondes</span></div>
    
<div class="viewcode-block" id="Mission.get_vdms"><a class="viewcode-back" href="../../../api/generated/tropycal.recon.Mission.get_vdms.html#tropycal.recon.Mission.get_vdms">[docs]</a>    <span class="k">def</span> <span class="nf">get_vdms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns Vortex Data Messages (VDMs) for this mission.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            Dictionary containing VDM data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vdms</span></div>
    
<div class="viewcode-block" id="Mission.status"><a class="viewcode-back" href="../../../api/generated/tropycal.recon.Mission.status.html#tropycal.recon.Mission.status">[docs]</a>    <span class="k">def</span> <span class="nf">status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the current mission status.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            String corresponding to the current mission status.</span>
<span class="sd">        </span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This function returns four possible values:</span>
<span class="sd">        </span>
<span class="sd">        .. list-table:: </span>
<span class="sd">           :widths: 25 75</span>
<span class="sd">           :header-rows: 1</span>

<span class="sd">           * - Value</span>
<span class="sd">             - Description</span>
<span class="sd">           * - &quot;En Route&quot;</span>
<span class="sd">             - Mission has not flown higher than 650 hPa or initial peak altitude yet</span>
<span class="sd">           * - &quot;In Progress&quot;</span>
<span class="sd">             - Mission has descended below 650 hPa, or is constant below 650 hPa</span>
<span class="sd">           * - &quot;Finished&quot;</span>
<span class="sd">             - Mission has re-ascended above 650 hPa for a sufficient duration</span>
<span class="sd">           * - &quot;Upper Air&quot;</span>
<span class="sd">             - Mission is a NOAA9 aircraft, suggesting it is an upper-level mission.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdobs</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></div>
    
<div class="viewcode-block" id="Mission.plot_points"><a class="viewcode-back" href="../../../api/generated/tropycal.recon.Mission.plot_points.html#tropycal.recon.Mission.plot_points">[docs]</a>    <span class="k">def</span> <span class="nf">plot_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">varname</span><span class="o">=</span><span class="s1">&#39;wspd&#39;</span><span class="p">,</span><span class="n">in_storm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">barbs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">plot_vdms</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s2">&quot;dynamic&quot;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">cartopy_proj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a plot of High Density Observations (HDOBs) data points.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        varname : str</span>
<span class="sd">            Variable to plot. Can be one of the following keys in dataframe:</span>
<span class="sd">            </span>
<span class="sd">            * **&quot;sfmr&quot;** = SFMR surface wind</span>
<span class="sd">            * **&quot;wspd&quot;** = 30-second flight level wind (default)</span>
<span class="sd">            * **&quot;pkwnd&quot;** = 10-second flight level wind</span>
<span class="sd">            * **&quot;p_sfc&quot;** = extrapolated surface pressure</span>
<span class="sd">        in_storm : bool, optional</span>
<span class="sd">            If True, only plots points considered within the storm, or all points if en route. Default is False (plot all points).</span>
<span class="sd">        barbs : bool, optional</span>
<span class="sd">            If True, plots wind barbs. If False (default), plots dots.</span>
<span class="sd">        plot_vdms : bool, optional</span>
<span class="sd">            If True, plots a dot with the minimum MSLP (hPa) from all mission VDMs. Default is False.</span>
<span class="sd">        domain : str, optional</span>
<span class="sd">            Domain for the plot. Default is &quot;dynamic&quot;. Please refer to :ref:`options-domain` for available domain options.</span>
<span class="sd">        ax : axes, optional</span>
<span class="sd">            Instance of axes to plot on. If none, one will be generated. Default is none.</span>
<span class="sd">        cartopy_proj : ccrs, optional</span>
<span class="sd">            Instance of a cartopy projection to use. If none, one will be generated. Default is none.</span>
<span class="sd">            </span>
<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        prop : dict</span>
<span class="sd">            Customization properties of recon plot. Please refer to :ref:`options-prop-recon-plot` for available options.</span>
<span class="sd">        map_prop : dict</span>
<span class="sd">            Customization properties of Cartopy map. Please refer to :ref:`options-map-prop` for available options.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ax</span>
<span class="sd">            Instance of axes containing the plot is returned.</span>
<span class="sd">        </span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        1. Plotting wind barbs only works for wind related variables. ``barbs`` will be automatically set to False for non-wind variables.</span>
<span class="sd">        </span>
<span class="sd">        2. The special colormap **category_recon** can be used in the prop dict (``prop={&#39;cmap&#39;:&#39;category_recon&#39;}``). This uses the standard SSHWS colormap, but with a new color for wind between 50 and 64 knots.</span>
<span class="sd">        </span>
<span class="sd">        .. warning::</span>

<span class="sd">            The ``in_storm`` flag uses an internal algorithm to determine if the recon mission is near the storm, without knowledge of the actual coordinates of the storm. This algorithm works well for most standard recon missions, but can return unexpected results for the occasional outlier missions or incomplete/aborted missions.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1">#Change barbs</span>
        <span class="k">if</span> <span class="n">varname</span> <span class="o">==</span> <span class="s1">&#39;p_sfc&#39;</span><span class="p">:</span> <span class="n">barbs</span> <span class="o">=</span> <span class="kc">False</span>
        
        <span class="c1">#Pop kwargs</span>
        <span class="n">prop</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;prop&#39;</span><span class="p">,{})</span>
        <span class="n">map_prop</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;map_prop&#39;</span><span class="p">,{})</span>
                
        <span class="c1">#Get plot data</span>
        <span class="k">if</span> <span class="n">in_storm</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">aircraft</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;NOAA9&#39;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">dfRecon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdobs</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">hdobs</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;In Storm&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dfRecon</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">dfRecon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdobs</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">dfRecon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdobs</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dfRecon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdobs</span>
        
        <span class="c1">#Create instance of plot object</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_obj</span> <span class="o">=</span> <span class="n">ReconPlot</span><span class="p">()</span>
        
        <span class="c1">#Create cartopy projection</span>
        <span class="k">if</span> <span class="n">cartopy_proj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_obj</span><span class="o">.</span><span class="n">create_cartopy</span><span class="p">(</span><span class="n">proj</span><span class="o">=</span><span class="s1">&#39;PlateCarree&#39;</span><span class="p">,</span><span class="n">central_longitude</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
            <span class="n">cartopy_proj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_obj</span><span class="o">.</span><span class="n">proj</span>
        
        <span class="c1">#Get VDMs</span>
        <span class="k">if</span> <span class="n">plot_vdms</span><span class="p">:</span>
            <span class="n">vdms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vdms</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vdms</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1">#Plot recon</span>
        <span class="n">plot_ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_obj</span><span class="o">.</span><span class="n">plot_points</span><span class="p">(</span><span class="n">PseudoStorm</span><span class="p">(),</span><span class="n">dfRecon</span><span class="p">,</span><span class="n">domain</span><span class="p">,</span><span class="n">barbs</span><span class="o">=</span><span class="n">barbs</span><span class="p">,</span><span class="n">varname</span><span class="o">=</span><span class="n">varname</span><span class="p">,</span><span class="n">radlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="n">prop</span><span class="p">,</span><span class="n">map_prop</span><span class="o">=</span><span class="n">map_prop</span><span class="p">,</span><span class="n">mission</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">vdms</span><span class="o">=</span><span class="n">vdms</span><span class="p">,</span><span class="n">mission_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mission_id</span><span class="p">)</span>
        
        <span class="c1">#Return axis</span>
        <span class="k">return</span> <span class="n">plot_ax</span></div>
        
<div class="viewcode-block" id="Mission.plot_skewt"><a class="viewcode-back" href="../../../api/generated/tropycal.recon.Mission.plot_skewt.html#tropycal.recon.Mission.plot_skewt">[docs]</a>    <span class="k">def</span> <span class="nf">plot_skewt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">number</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot a single dropsonde Skew-T for a given dropsonde number.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        number : int</span>
<span class="sd">            Number of dropsonde during mission. If None (default), plots the latest available dropsonde.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig</span>
<span class="sd">            Figure instance containing the plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1">#Retrieve data for dropsonde number</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">number</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="n">number</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dropsondes</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">number</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">number</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dropsondes</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dropsondes</span><span class="p">[</span><span class="n">number</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Requested dropsonde number not available.&quot;</span><span class="p">)</span>
        
        <span class="c1">#Format title string</span>
        <span class="n">title_string</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Mission ID: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mission_id</span><span class="si">}</span><span class="se">\n</span><span class="s1">Dropsonde #</span><span class="si">{</span><span class="n">number</span><span class="si">}</span><span class="s1">&#39;</span>
        
        <span class="k">return</span> <span class="n">plot_skewt</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">title_string</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="Mission.plot_time_series"><a class="viewcode-back" href="../../../api/generated/tropycal.recon.Mission.plot_time_series.html#tropycal.recon.Mission.plot_time_series">[docs]</a>    <span class="k">def</span> <span class="nf">plot_time_series</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">varname</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;p_sfc&#39;</span><span class="p">,</span><span class="s1">&#39;wspd&#39;</span><span class="p">),</span><span class="n">time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">realtime</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots a time series of one or two variables on an axis.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        varname : str or tuple</span>
<span class="sd">            If one variable to plot, varname is a string of the variable name. If two variables to plot, varname is a tuple of the left and right variable names, respectively. Available varnames are:</span>
<span class="sd">            </span>
<span class="sd">            * **p_sfc** - Mean Sea Level Pressure (hPa)</span>
<span class="sd">            * **temp** - Flight Level Temperature (C)</span>
<span class="sd">            * **dwpt** - Flight Level Dewpoint (C)</span>
<span class="sd">            * **wspd** - Flight Level Wind (kt)</span>
<span class="sd">            * **sfmr** - Surface Wind (kt)</span>
<span class="sd">            * **pkwnd** - Peak Wind Gust (kt)</span>
<span class="sd">            * **rain** - Rain Rate (mm/hr)</span>
<span class="sd">            * **plane_z** - Geopotential Height (m)</span>
<span class="sd">            * **plane_p** - Pressure (hPa)</span>
<span class="sd">        time : tuple</span>
<span class="sd">            Tuple of start and end times (datetime.datetime) to plot. If None, all times available are plotted.</span>
<span class="sd">        realtime : bool</span>
<span class="sd">            If True, the most recent 2 hours of the mission will plot, overriding the time argument. Default is False.</span>
<span class="sd">        </span>
<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        left_prop : dict</span>
<span class="sd">            Dictionary of properties for the left line. Scroll down for more information.</span>
<span class="sd">        right_prop : dict</span>
<span class="sd">            Dictionary of properties for the right line. Scroll down for more information.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ax</span>
<span class="sd">            Instance of axes containing the plot is returned.</span>
<span class="sd">        </span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The following properties are available for customizing the plot, via ``left_prop`` and ``right_prop``.</span>

<span class="sd">        .. list-table:: </span>
<span class="sd">           :widths: 25 75</span>
<span class="sd">           :header-rows: 1</span>

<span class="sd">           * - Property</span>
<span class="sd">             - Description</span>
<span class="sd">           * - ms</span>
<span class="sd">             - Marker size. If zero, none will be plotted. Default is zero.</span>
<span class="sd">           * - color</span>
<span class="sd">             - Color of lines (and markers if used). Default varies per varname.</span>
<span class="sd">           * - linewidth</span>
<span class="sd">             - Line width. Default is 1.0.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1">#Pop kwargs</span>
        <span class="n">left_prop</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;left_prop&#39;</span><span class="p">,{})</span>
        <span class="n">right_prop</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;right_prop&#39;</span><span class="p">,{})</span>
        
        <span class="c1">#Retrieve variables</span>
        <span class="n">twin_ax</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
            <span class="n">varname_right</span> <span class="o">=</span> <span class="n">varname</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">varname</span> <span class="o">=</span> <span class="n">varname</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">twin_ax</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">varname_right_info</span> <span class="o">=</span> <span class="n">time_series_plot</span><span class="p">(</span><span class="n">varname_right</span><span class="p">)</span>
        <span class="n">varname_info</span> <span class="o">=</span> <span class="n">time_series_plot</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span>
        
        <span class="c1">#Get data</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdobs</span>
        
        <span class="c1">#Filter by time or realtime flag</span>
        <span class="k">if</span> <span class="n">realtime</span><span class="p">:</span>
            <span class="n">end_time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">end_time</span><span class="o">-</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">end_time</span><span class="p">)]</span>
        <span class="k">elif</span> <span class="n">time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">time</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Time range provided is invalid.&quot;</span><span class="p">)</span>
        
        <span class="c1">#Filter by default kwargs</span>
        <span class="n">left_prop_default</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ms&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="n">varname_info</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">],</span><span class="s1">&#39;linewidth&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">left_prop</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="n">left_prop_default</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">left_prop</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="n">left_prop</span> <span class="o">=</span> <span class="n">left_prop_default</span>
        <span class="k">if</span> <span class="n">twin_ax</span><span class="p">:</span>
            <span class="n">right_prop_default</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ms&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="n">varname_right_info</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">],</span><span class="s1">&#39;linewidth&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">right_prop</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="n">right_prop_default</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">right_prop</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="n">right_prop</span> <span class="o">=</span> <span class="n">right_prop_default</span>
        
        <span class="c1">#----------------------------------------------------------------------------------</span>
        
        <span class="c1">#Create figure</span>
        <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">twin_ax</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        
        <span class="c1">#Plot line</span>
        <span class="n">line1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="n">varname</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">left_prop</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">],</span><span class="n">linewidth</span><span class="o">=</span><span class="n">left_prop</span><span class="p">[</span><span class="s1">&#39;linewidth&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="n">varname_info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">varname_info</span><span class="p">[</span><span class="s1">&#39;full_name&#39;</span><span class="p">])</span>
        
        <span class="c1">#Plot dots</span>
        <span class="k">if</span> <span class="n">left_prop</span><span class="p">[</span><span class="s1">&#39;ms&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">plot_times</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">plot_var</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">varname</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">plot_times</span> <span class="o">=</span> <span class="p">[</span><span class="n">plot_times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plot_times</span><span class="p">))</span> <span class="k">if</span> <span class="n">varname</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;flag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
            <span class="n">plot_var</span> <span class="o">=</span> <span class="p">[</span><span class="n">plot_var</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plot_var</span><span class="p">))</span> <span class="k">if</span> <span class="n">varname</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;flag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plot_times</span><span class="p">,</span><span class="n">plot_var</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">left_prop</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">],</span><span class="n">ms</span><span class="o">=</span><span class="n">left_prop</span><span class="p">[</span><span class="s1">&#39;ms&#39;</span><span class="p">])</span>
        
        <span class="c1">#Format x-axis dates</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%H:%Mz</span><span class="se">\n</span><span class="s1">%m/</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">))</span>
        
        <span class="c1">#Add twin axis</span>
        <span class="k">if</span> <span class="n">twin_ax</span><span class="p">:</span>
            <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
            
            <span class="c1">#Plot line</span>
            <span class="n">line2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="n">varname_right</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">right_prop</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">],</span><span class="n">linewidth</span><span class="o">=</span><span class="n">right_prop</span><span class="p">[</span><span class="s1">&#39;linewidth&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="n">varname_right_info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">varname_right_info</span><span class="p">[</span><span class="s1">&#39;full_name&#39;</span><span class="p">])</span>
            
            <span class="c1">#Plot dots</span>
            <span class="k">if</span> <span class="n">right_prop</span><span class="p">[</span><span class="s1">&#39;ms&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">plot_times</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">plot_var</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">varname_right</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">plot_times</span> <span class="o">=</span> <span class="p">[</span><span class="n">plot_times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plot_times</span><span class="p">))</span> <span class="k">if</span> <span class="n">varname_right</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;flag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                <span class="n">plot_var</span> <span class="o">=</span> <span class="p">[</span><span class="n">plot_var</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plot_var</span><span class="p">))</span> <span class="k">if</span> <span class="n">varname_right</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;flag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plot_times</span><span class="p">,</span><span class="n">plot_var</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">right_prop</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">],</span><span class="n">ms</span><span class="o">=</span><span class="n">right_prop</span><span class="p">[</span><span class="s1">&#39;ms&#39;</span><span class="p">])</span>

            <span class="c1">#Add legend</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">line1</span> <span class="o">+</span> <span class="n">line2</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">l</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span><span class="n">labels</span><span class="p">)</span>
        
            <span class="c1">#Special handling if both are in units of Celsius</span>
            <span class="n">same_unit</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">varname</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">,</span><span class="s1">&#39;dwpt&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">varname_right</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">,</span><span class="s1">&#39;dwpt&#39;</span><span class="p">]:</span> <span class="n">same_unit</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">varname</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;sfmr&#39;</span><span class="p">,</span><span class="s1">&#39;wspd&#39;</span><span class="p">,</span><span class="s1">&#39;pkwnd&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">varname_right</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;sfmr&#39;</span><span class="p">,</span><span class="s1">&#39;wspd&#39;</span><span class="p">,</span><span class="s1">&#39;pkwnd&#39;</span><span class="p">]:</span> <span class="n">same_unit</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">same_unit</span><span class="p">:</span>
                <span class="n">min_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">varname</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">varname_right</span><span class="p">])])</span>
                <span class="n">max_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">varname</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">varname_right</span><span class="p">])])</span><span class="o">*</span><span class="mf">1.05</span>
                <span class="n">min_val</span> <span class="o">=</span> <span class="n">min_val</span> <span class="o">*</span> <span class="mf">1.05</span> <span class="k">if</span> <span class="n">min_val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">min_val</span> <span class="o">*</span> <span class="mf">0.95</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">min_val</span><span class="p">):</span> <span class="n">min_val</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">max_val</span><span class="p">):</span> <span class="n">max_val</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="n">min_val</span> <span class="o">==</span> <span class="n">max_val</span><span class="p">:</span>
                    <span class="n">min_val</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">max_val</span> <span class="o">=</span> <span class="mi">10</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">min_val</span><span class="p">,</span><span class="n">max_val</span><span class="p">)</span>
                <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">min_val</span><span class="p">,</span><span class="n">max_val</span><span class="p">)</span>
        
        <span class="c1">#Add titles</span>
        <span class="n">title_string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Recon Aircraft HDOBs</span><span class="se">\n</span><span class="s2">Mission ID: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mission_id</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title_string</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Plot generated using Tropycal&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
        
        <span class="c1">#Return plot</span>
        <span class="k">return</span> <span class="n">ax</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Tropycal Developers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>